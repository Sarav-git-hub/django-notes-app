{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4 mt-3">
    <h1 class="text-primary fw-bold">My SmartNotes</h1>
    <a href="{% url 'create_note' %}" class="btn btn-primary px-4 shadow-sm">+ Create New Note</a>
</div>

{% if request.GET.q %}
    <div class="alert alert-light border mb-4">
        Search results for: <span class="text-primary fw-bold">"{{ request.GET.q }}"</span>
        <a href="{% url 'index' %}" class="text-muted ms-2 small text-decoration-none">Clear</a>
    </div>
{% endif %}

<div class="row">
    {% for n in notes %}
    <div class="col-md-4 mb-4">
        <div class="card h-100 shadow-sm {% if n.is_pinned %}border-warning border-3 shadow{% else %}border-0{% endif %}">
            <div class="card-body d-flex flex-column">
                
                <div class="d-flex justify-content-between align-items-start mb-2">
                    <h5 class="card-title fw-bold {% if n.is_pinned %}text-dark{% else %}text-primary{% endif %}">
                        {{ n.title }}
                    </h5>
                    <a href="{% url 'toggle_pin' n.id %}" class="text-decoration-none fs-4" title="Pin/Unpin Note">
                        {% if n.is_pinned %} ğŸ“Œ {% else %} ğŸ“ {% endif %}
                    </a>
                </div>

                <p class="text-muted small mb-3">
                    ğŸ“… {{ n.created_at|date:"d M, Y" }}
                </p>

                <p class="card-text text-dark flex-grow-1">{{ n.content|truncatechars:120 }}</p>
                
                <div class="mt-3 pt-3 border-top">
                    <div class="d-flex justify-content-between">
                        <a href="{% url 'edit_note' n.id %}" class="btn btn-outline-success btn-sm px-3">Update</a>
                        <a href="{% url 'delete_note' n.id %}" class="btn btn-outline-danger btn-sm px-3" onclick="return confirm('Confirm Delete?')">Delete</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12 text-center py-5">
        <h4 class="text-muted">No Notes Found</h4>
    </div>
    {% endfor %}
</div>
{% endblock %}